webpackJsonp([7],{FHEk:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("a3Yh"),o=r.n(i),l=(r("oTFt"),r("9GaO"),r("v/ij"),r("aiqZ")),a={"ql-bold":"加粗","ql-color":"颜色","ql-font":"字体","ql-code":"插入代码","ql-italic":"斜体","ql-link":"添加链接","ql-background":"背景颜色","ql-size":"字体大小","ql-strike":"删除线","ql-script":"上标/下标","ql-underline":"下划线","ql-blockquote":"引用","ql-header":"标题","ql-indent":"缩进","ql-list":"列表","ql-align":"文本对齐","ql-direction":"文本方向","ql-code-block":"代码块","ql-formula":"公式","ql-image":"图片","ql-video":"视频","ql-clean":"清除字体样式"};Vue.directive("loadmore",{bind:function(e,t){e.querySelector(".el-select-dropdown .el-select-dropdown__wrap").addEventListener("scroll",function(){this.scrollHeight-this.scrollTop<=this.clientHeight&&t.value()})}});var s=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["link","image","video"],["clean"]],n={name:"addproject",components:{quillEditor:l.quillEditor},data:function(){var e;return{editorOption:{placeholder:"请输入文章内容",modules:{toolbar:{container:s,handlers:{image:function(e){e?document.querySelector("#upload").click():this.quill.format("image",!1)}}}},them:"snow",readOnly:!0},hideUpload:!1,limitCount:1,form:(e={name:"",image:"",specification:"",deliver_addr:"",goods_type_id:"",price_now:"",price_origin:""},o()(e,"specification",""),o()(e,"service",""),o()(e,"sold_num",""),o()(e,"inventory",""),o()(e,"is_banner",""),o()(e,"is_seckill",""),o()(e,"is_recommand",""),o()(e,"free_mail",""),o()(e,"free_tax",""),o()(e,"detail_url",""),o()(e,"detail_content",""),e),keywordsdata:"",typedata:"",id:"",res:"",imageList:"",imageurl1:"",option1:[{value:0,label:"否"},{value:1,label:"是"}],uploadurl:"http://api-backend.5youfenqi.com/",goodstype:"",premiumdata:[{id:0,name:"非精选"},{id:1,name:"精选"}],rules:{name:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],goods_type_id:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],price_now:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],price_origin:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],specification:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],deliver_addr:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],service:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],sold_num:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],inventory:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],is_banner:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],is_seckill:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],is_recommand:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],free_mail:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],free_tax:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],detail_url:[{required:!0,message:"不可为空！",trigger:["blur","change"]}]}}},created:function(){this.id=this.$route.query.id,this.getgoodstype(),this.id&&(this.getlistdata(),this.imageshow=!0)},mounted:function(){var e,t,r;e=document.querySelector(".ql-toolbar"),t=e.querySelectorAll("button"),r=e.querySelectorAll("select"),t.forEach(function(e){"ql-script"===e.className?"sub"===e.value?e.title="下标":e.title="上标":"ql-indent"===e.className?"+1"===e.value?e.title="向右缩进":e.title="向左缩进":e.title=a[e.classList[0]]}),r.forEach(function(e){e.parentNode.title=a[e.classList[0]]})},computed:{editor:function(){return this.$refs.myQuillEditor.quill}},methods:{getgoodstype:function(){var e=this;this.$get("good/get-type").then(function(t){console.log(t),1===t.code?(e.goodstype=t.info,console.log(e.goodstype)):e.$message.error(t.message),e.loading=!1}).catch(function(){e.loading=!1})},getlistdata:function(){var e=this;this.$get("goods/"+this.id).then(function(t){console.log(t),1===t.code?e.tableData=t.info.items[0]:e.$message.error("数据加载失败"),e.form=e.tableData,e.loading=!1}).catch(function(){e.loading=!1})},onEditorChange:function(e){e.editor;var t=e.html;e.text;this.content=t},addAttachment:function(e){var t=this;this.imageUrl=URL.createObjectURL(e.file),console.log(this.imageUrl),this.fileData=e.file,console.log(this.fileData);var r=new FormData;r.append("file",this.fileData),axios({method:"post",url:this.uploadurl+"upload-to-aliyun_oss?type=product",data:r,config:{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+localStorage.getItem("token")}}}).then(function(e){if(console.log(e),1==e.data.code){t.imageurl=e.data.info.url,t.res=e.data.info.url,console.log(t.res),t.$message({message:"上传成功",type:"success"});var r=t.$refs.QuillEditor.quill;console.log(r);var i=r.getSelection().index;r.insertEmbed(i,"image",t.res),r.setSelection(i+1)}else t.$message.error(e.data.message)}).catch(function(e){t.$message.error(e.message)})},uploadfile:function(e){var t=this;this.imageUrl1=URL.createObjectURL(e.file),this.fileData=e.file,console.log(this.fileData);var r=new FormData;r.append("file",this.fileData),axios({method:"post",url:this.uploadurl+"upload-to-aliyun_oss?type=product",data:r,config:{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+localStorage.getItem("token")}}}).then(function(e){console.log(e),1==e.data.code?(t.imageurl1=e.data.info.url,t.$message({message:"上传成功",type:"success"})):t.$message.error(e.data.message)}).catch(function(e){t.$message.error(e.message)})},onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message.error(" 请完善红色提示内容"),!1;var r;console.log(t.form.label_id_list),t.$post("goods",(r={detail_content:t.form.detail_content,image:t.imageurl1,name:t.form.name,specification:t.form.specification,deliver_addr:t.form.deliver_addr,goods_type_id:t.form.goods_type_id,price_now:t.form.price_now,price_origin:t.form.price_origin},o()(r,"specification",t.form.specification),o()(r,"service",t.form.service),o()(r,"sold_num",t.form.sold_num),o()(r,"inventory",t.form.inventory),o()(r,"is_banner",t.form.is_banner),o()(r,"is_seckill",t.form.is_seckill),o()(r,"is_recommand",t.form.is_recommand),o()(r,"free_mail",t.form.free_mail),o()(r,"free_tax",t.form.free_tax),o()(r,"detail_url",t.form.detail_url),r)).then(function(e){console.log(e),1===e.code?(t.$message({message:e.message,type:"success"}),t.$router.push("/goods")):e.info.name?t.$message.error(e.info.name[0]):t.$message.error(e.message)})})},onEdit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message.error(" 请完善红色提示内容"),!1;var r;t.$put("goods/"+t.id,(r={detail_content:t.form.detail_content,image:t.imageurl1?t.imageurl1:t.tableData.preview_image,name:t.form.name,specification:t.form.specification,deliver_addr:t.form.deliver_addr,goods_type_id:t.form.goods_type_id,price_now:t.form.price_now,price_origin:t.form.price_origin},o()(r,"specification",t.form.specification),o()(r,"service",t.form.service),o()(r,"sold_num",t.form.sold_num),o()(r,"inventory",t.form.inventory),o()(r,"is_banner",t.form.is_banner),o()(r,"is_seckill",t.form.is_seckill),o()(r,"is_recommand",t.form.is_recommand),o()(r,"free_mail",t.form.free_mail),o()(r,"free_tax",t.form.free_tax),o()(r,"detail_url",t.form.detail_url),r)).then(function(e){console.log(e),1===e.code?(t.$message({message:e.message,type:"success"}),t.$router.push("/goods")):e.info.name?t.$message.error(e.info.name[0]):t.$message.error(e.message)})})},imgChange:function(e,t){this.hideUpload=t.length>=this.limitCount,t&&this.$refs.uploadElemet.clearValidate()},handleRemove1:function(e,t){console.log(e,t),this.hideUpload=t.length>=this.limitCount},handleChange1:function(e,t){console.log(111),this.fileList1=t.slice(-1),this.imageshow=!1,console.log(this.imageshow)}}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("div",{staticClass:"container-title"},[e._v("新增文章")]),e._v(" "),r("el-form",{ref:"form",staticClass:"item-add-list",attrs:{model:e.form,enctype:"multipart/form-data",rules:e.rules}},[r("el-form-item",{attrs:{label:"商品名称:",prop:"name"}},[r("el-input",{attrs:{type:"text"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"==typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"规格:",prop:"specification"}},[r("el-input",{model:{value:e.form.specification,callback:function(t){e.$set(e.form,"specification","string"==typeof t?t.trim():t)},expression:"form.specification"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"类型:",prop:"goods_type_id"}},[[r("el-select",{attrs:{placeholder:"请选择类型"},model:{value:e.form.goods_type_id,callback:function(t){e.$set(e.form,"goods_type_id",t)},expression:"form.goods_type_id"}},e._l(e.goodstype,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)]],2),e._v(" "),r("el-form-item",{attrs:{label:"发货地",prop:"deliver_addr"}},[r("el-input",{model:{value:e.form.deliver_addr,callback:function(t){e.$set(e.form,"deliver_addr","string"==typeof t?t.trim():t)},expression:"form.deliver_addr"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"销量:",prop:"sold_num"}},[r("el-input",{attrs:{type:"text"},model:{value:e.form.sold_num,callback:function(t){e.$set(e.form,"sold_num","string"==typeof t?t.trim():t)},expression:"form.sold_num"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"库存:",prop:"inventory"}},[r("el-input",{attrs:{type:"text"},model:{value:e.form.inventory,callback:function(t){e.$set(e.form,"inventory","string"==typeof t?t.trim():t)},expression:"form.inventory"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"原价:",prop:"price_origin"}},[r("el-input",{attrs:{type:"text"},model:{value:e.form.price_origin,callback:function(t){e.$set(e.form,"price_origin","string"==typeof t?t.trim():t)},expression:"form.price_origin"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"现价:",prop:"price_now"}},[r("el-input",{attrs:{type:"text"},model:{value:e.form.price_now,callback:function(t){e.$set(e.form,"price_now","string"==typeof t?t.trim():t)},expression:"form.price_now"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"是否免税:",prop:"free_tax"}},[[r("el-select",{attrs:{placeholder:"请选择是否免税"},model:{value:e.form.free_tax,callback:function(t){e.$set(e.form,"free_tax",t)},expression:"form.free_tax"}},e._l(e.option1,function(e){return r("el-option",{key:e.key,attrs:{label:e.label,value:e.value}})}),1)]],2),e._v(" "),r("el-form-item",{attrs:{label:"是否是轮播:",prop:"is_banner"}},[[r("el-select",{attrs:{placeholder:"请选择是否是轮播"},model:{value:e.form.is_banner,callback:function(t){e.$set(e.form,"is_banner",t)},expression:"form.is_banner"}},e._l(e.option1,function(e){return r("el-option",{key:e.key,attrs:{label:e.label,value:e.value}})}),1)]],2),e._v(" "),r("el-form-item",{attrs:{label:"是否推荐:",prop:"is_recommand"}},[[r("el-select",{attrs:{placeholder:"请选择是否推荐"},model:{value:e.form.is_recommand,callback:function(t){e.$set(e.form,"is_recommand",t)},expression:"form.is_recommand"}},e._l(e.option1,function(e){return r("el-option",{key:e.key,attrs:{label:e.label,value:e.value}})}),1)]],2),e._v(" "),r("el-form-item",{attrs:{label:"是否包邮:",prop:"free_mail"}},[[r("el-select",{attrs:{placeholder:"请选择是否包邮"},model:{value:e.form.free_mail,callback:function(t){e.$set(e.form,"free_mail",t)},expression:"form.free_mail"}},e._l(e.option1,function(e){return r("el-option",{key:e.key,attrs:{label:e.label,value:e.value}})}),1)]],2),e._v(" "),r("el-form-item",{attrs:{label:"是否秒杀:",prop:"is_seckill"}},[[r("el-select",{attrs:{placeholder:"请选择是否秒杀"},model:{value:e.form.is_seckill,callback:function(t){e.$set(e.form,"is_seckill",t)},expression:"form.is_seckill"}},e._l(e.option1,function(e){return r("el-option",{key:e.key,attrs:{label:e.label,value:e.value}})}),1)]],2),e._v(" "),r("el-form-item",{attrs:{label:"服务:",prop:"service"}},[r("el-input",{attrs:{type:"text"},model:{value:e.form.service,callback:function(t){e.$set(e.form,"service","string"==typeof t?t.trim():t)},expression:"form.service"}})],1),e._v(" "),r("el-form-item",{ref:"uploadElemet",attrs:{prop:"image"}},[r("el-upload",{staticClass:"upload-demo1",attrs:{"on-preview":e.handlePreview1,"on-remove":e.handleRemove1,"file-list":e.fileList1,"list-type":"picture","on-change":e.handleChange1,"http-request":e.uploadfile}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传产品图片")])],1),e._v(" "),r("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],model:{value:e.imageurl1,callback:function(t){e.imageurl1="string"==typeof t?t.trim():t},expression:"imageurl1"}}),e._v(" "),e.imageshow?r("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.form.image,alt:""}}):e._e()],1),e._v(" "),r("el-form-item",{attrs:{prop:"detail_content"}},[r("el-upload",{staticClass:"upload-demo",attrs:{"on-preview":e.handlePreview,"on-remove":e.handleRemove,"file-list":e.fileList,"list-type":"picture","on-change":e.handleChange,"http-request":e.addAttachment,"on-success":e.handleSuccess}},[r("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{size:"small",id:"upload",type:"primary"}},[e._v("点击上传图片")])],1),e._v(" "),r("quill-editor",{ref:"QuillEditor",staticClass:"editor",attrs:{options:e.editorOption},model:{value:e.form.detail_content,callback:function(t){e.$set(e.form,"detail_content",t)},expression:"form.detail_content"}})],1)],1),e._v(" "),e.tableData?e._e():r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("提交")]),e._v(" "),e.tableData?r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onEdit("form")}}},[e._v("保存")]):e._e(),e._v(" "),r("router-link",{attrs:{to:{path:"goods"}}},[r("el-button",{attrs:{type:"primary"}},[e._v("取消")])],1)],1)},staticRenderFns:[]};var m=r("C7Lr")(n,c,!1,function(e){r("mtsu"),r("eb+b")},null,null);t.default=m.exports},"eb+b":function(e,t){},mtsu:function(e,t){}});