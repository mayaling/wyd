webpackJsonp([14],{"/LOI":function(e,t){},AIlc:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("a3Yh"),i=a.n(o),s={name:"addadmin",data:function(){var e;return{uploadurl:"http://service.xykj1.com/",showweb:!1,showid:!1,imageList:"",imageurl1:"",form:(e={good_id:"",status:"",type:""},i()(e,"good_id",""),i()(e,"web_url",""),i()(e,"image_url",""),e),option1:[{value:0,label:"否"},{value:1,label:"是"}],typedata:[{id:0,name:"创业帮"},{id:2,name:"外链"}],statusdata:[{id:1,name:"开启"},{id:0,name:"关闭"}],tableData:"",id:"",data:"",rules:{name:[{required:!0,message:"不可为空！",trigger:"blur"}],status:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],type:[{required:!0,message:"不可为空！",trigger:["blur","change"]}]}}},created:function(){this.id=this.$route.query.id,this.id&&(this.getformdata(),this.imageshow=!0)},computed:{},methods:{checktype:function(){2===this.form.type?(this.showweb=!0,this.showid=!1):(this.showid=!0,this.showweb=!1)},uploadfile:function(e){var t=this;this.imageUrl1=URL.createObjectURL(e.file),this.fileData=e.file,console.log(this.fileData);var a=new FormData;a.append("file",this.fileData),axios({method:"post",url:"http://api-backend.5youfenqi.com/upload-to-aliyun_oss?type=product",data:a,config:{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+localStorage.getItem("token")}}}).then(function(e){console.log(e),1==e.data.code?(t.imageurl1=e.data.info.url,t.$message({message:"上传成功",type:"success"})):t.$message.error(e.data.message)}).catch(function(e){t.$message.error(e.message)})},getformdata:function(){var e=this;this.$get("good/get-banner-detail?id="+this.id).then(function(t){console.log(t),1===t.code?(e.tableData=t.info.items[0],console.log(e.tableData),e.form=e.tableData,e.loading=!1):e.$message.error("数据加载失败")}).catch(function(){e.loading=!1})},onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message.error("请完善红色提醒内容"),!1;t.$post("good/post-banner",{status:t.form.status,image_url:t.imageurl1,good_id:t.form.good_id?t.form.good_id:0}).then(function(e){console.log(e),1===e.code?t.$router.push("/wymbanner"):e.info.name?t.$message.error(e.info.name[0]):t.$message.error(e.message)})})},onEdit:function(e){var t=this;console.log(this.form),this.$refs[e].validate(function(e){if(!e)return!1;t.$post("good/edit-banner?id="+t.id,{status:t.form.status,image_url:t.imageurl1?t.imageurl1:t.tableData.image_url,good_id:t.form.good_id?t.form.good_id:0}).then(function(e){1===e.code?t.$router.push("/wymbanner"):t.$message.error(e.message)})})},resetForm:function(e){this.$refs[e].resetFields()},imgChange:function(e,t){this.hideUpload=t.length>=this.limitCount,t&&this.$refs.uploadElemet.clearValidate()},handleRemove1:function(e,t){console.log(e,t),this.hideUpload=t.length>=this.limitCount},handleChange1:function(e,t){console.log(111),this.fileList1=t.slice(-1),this.imageshow=!1,console.log(this.imageshow)}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table",attrs:{"element-loading-text":"加载中"}},[a("div",{staticClass:"container"},[a("div",{staticClass:"container-title"},[e._v("新增无忧米banner")]),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:6}},[a("el-form",{ref:"form",staticClass:"item-add-list",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"商品id:",prop:"good_id"}},[a("el-input",{attrs:{type:"text"},model:{value:e.form.good_id,callback:function(t){e.$set(e.form,"good_id","string"==typeof t?t.trim():t)},expression:"form.good_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态:",prop:"status"}},[[a("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.option1,function(e){return a("el-option",{key:e.key,attrs:{label:e.label,value:e.value}})}),1)]],2),e._v(" "),a("el-form-item",{ref:"uploadElemet",attrs:{prop:"imageList"}},[a("el-upload",{staticClass:"upload-demo1",attrs:{"on-preview":e.handlePreview1,"on-remove":e.handleRemove1,"file-list":e.fileList1,"list-type":"picture","on-change":e.handleChange1,"http-request":e.uploadfile}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传banner图片")]),e._v(" "),a("span",[e._v("(尺寸)")])],1),e._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],model:{value:e.imageurl1,callback:function(t){e.imageurl1="string"==typeof t?t.trim():t},expression:"imageurl1"}}),e._v(" "),e.imageshow?a("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.form.image_url,alt:""}}):e._e()],1),e._v(" "),e.tableData?e._e():a("el-button",{staticStyle:{"margin-top":"40px"},attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("提交")]),e._v(" "),e.tableData?a("el-button",{staticStyle:{"margin-top":"40px"},attrs:{type:"primary"},on:{click:function(t){return e.onEdit("form")}}},[e._v("保存")]):e._e(),e._v(" "),a("router-link",{attrs:{to:{path:"wymbanner"}}},[a("el-button",{attrs:{type:"primary"}},[e._v("取消")])],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}}),e._v(" "),a("el-col",{attrs:{span:6}})],1)],1)])},staticRenderFns:[]};var n=a("C7Lr")(s,r,!1,function(e){a("/LOI")},"data-v-a4b56eca",null);t.default=n.exports}});